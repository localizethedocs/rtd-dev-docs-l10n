

<!DOCTYPE html>
<html class="writer-html5" lang="zh-CN" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />
<meta property="og:title" content="YAML configuration file" />
<meta property="og:type" content="website" />
<meta property="og:url" content="design/yaml-file.html" />
<meta property="og:site_name" content="Read the Docs Documentation" />
<meta property="og:description" content="Background: The current YAML configuration file is in beta state. There are many options and features that it doesn&#x27;t support yet. This document will serve as a design document for discuss how to implement the missing features. Scope: Finish the spec to include all the missing options, Have ..." />
<meta property="og:image" content="https://docs.readthedocs.io/en/latest/_static/img/logo-opengraph.png" />
<meta property="og:image:alt" content="Read the Docs Documentation" />
<meta name="description" content="Background: The current YAML configuration file is in beta state. There are many options and features that it doesn&#x27;t support yet. This document will serve as a design document for discuss how to implement the missing features. Scope: Finish the spec to include all the missing options, Have ..." />
<meta name="twitter:card" content="summary_large_image" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>YAML configuration file &mdash; Read the Docs developer documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
      <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
      <link rel="stylesheet" type="text/css" href="../_static/css/custom.css?v=ca6f9a36" />
      <link rel="stylesheet" type="text/css" href="../_static/css/sphinx_prompt_css.css?v=351d85e3" />

  
    <link rel="canonical" href="https://projects.localizethedocs.org/rtd-dev-docs-l10n/design/yaml-file.html" />
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=7dd903f3"></script>
      <script src="../_static/doctools.js?v=9bcbadda"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
      <script src="../_static/copybutton.js?v=f281be69"></script>
      <script src="../_static/translations.js?v=beaddf03"></script>
      <script src="../_static/design-tabs.js?v=f930bc37"></script>
      <script src="../_static/js/expand_tabs.js?v=1e151f68"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="索引" href="../genindex.html" />
    <link rel="search" title="搜索" href="../search.html" />
    <link rel="next" title="Development installation" href="../install.html" />
    <link rel="prev" title="Read the Docs data passed to Sphinx build context" href="theme-context.html" />

   

  

<script type="text/javascript" src="../ltd-provenance.js"></script>
<script type="text/javascript" src="../ltd-current.js"></script>
<script type="text/javascript" src="../../../ltd-config.js"></script>
<script type="text/javascript" src="../../../ltd-flyout.js"></script>

</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html">
            
              <img src="../_static/logo.svg" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="搜索文档" aria-label="搜索文档" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="导航菜单">
              <p class="caption" role="heading"><span class="caption-text">General</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../contribute.html">Contributing to Read the Docs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../code-of-conduct.html">Code of Conduct</a></li>
<li class="toctree-l1"><a class="reference internal" href="../issue-labels.html">Overview of issue labels</a></li>
<li class="toctree-l1"><a class="reference internal" href="../roadmap.html">Roadmap</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Design documents</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="apiv3.html">API v3 design document</a></li>
<li class="toctree-l2"><a class="reference internal" href="better-doc-urls-handling.html">Better handling of docs URLs</a></li>
<li class="toctree-l2"><a class="reference internal" href="build-images.html">Build images</a></li>
<li class="toctree-l2"><a class="reference internal" href="embed-api.html">Embed APIv3</a></li>
<li class="toctree-l2"><a class="reference internal" href="file-tree-diff.html">Version file tree diff</a></li>
<li class="toctree-l2"><a class="reference internal" href="flyout-redesign.html">Flyout Redesign Design Document</a></li>
<li class="toctree-l2"><a class="reference internal" href="future-builder.html">Future builder</a></li>
<li class="toctree-l2"><a class="reference internal" href="in-doc-search-ui.html">In-doc search UI</a></li>
<li class="toctree-l2"><a class="reference internal" href="new-notifications-system.html">Notification system: a new approach after lot of discussions</a></li>
<li class="toctree-l2"><a class="reference internal" href="new-search-api.html">New search API</a></li>
<li class="toctree-l2"><a class="reference internal" href="new-sphinx-guides.html">Proposed contents for new Sphinx guides</a></li>
<li class="toctree-l2"><a class="reference internal" href="organizations.html">Organizations</a></li>
<li class="toctree-l2"><a class="reference internal" href="pr-builder.html">Design of pull request builder</a></li>
<li class="toctree-l2"><a class="reference internal" href="privacy-levels.html">Privacy levels</a></li>
<li class="toctree-l2"><a class="reference internal" href="redirects.html">Improving redirects</a></li>
<li class="toctree-l2"><a class="reference internal" href="refactor-remote-repository.html">Refactor <code class="docutils literal notranslate"><span class="pre">RemoteRepository</span></code> object</a></li>
<li class="toctree-l2"><a class="reference internal" href="secure-api-access-from-builders.html">Secure API access from builders</a></li>
<li class="toctree-l2"><a class="reference internal" href="sphinx-jquery.html">sphinxcontrib-jquery</a></li>
<li class="toctree-l2"><a class="reference internal" href="system-packages.html">Allow installation of system packages</a></li>
<li class="toctree-l2"><a class="reference internal" href="telemetry.html">Collect data about builds</a></li>
<li class="toctree-l2"><a class="reference internal" href="theme-context.html">Read the Docs data passed to Sphinx build context</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">YAML configuration file</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#background">Background</a></li>
<li class="toctree-l3"><a class="reference internal" href="#scope">Scope</a></li>
<li class="toctree-l3"><a class="reference internal" href="#rtd-settings">RTD settings</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#not-applicable-settings">Not applicable settings</a></li>
<li class="toctree-l4"><a class="reference internal" href="#global-settings">Global settings</a></li>
<li class="toctree-l4"><a class="reference internal" href="#local-settings">Local settings</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#configuration-file">Configuration file</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#format">Format</a></li>
<li class="toctree-l4"><a class="reference internal" href="#conventions">Conventions</a></li>
<li class="toctree-l4"><a class="reference internal" href="#spec">Spec</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#versioning-the-spec">Versioning the spec</a></li>
<li class="toctree-l3"><a class="reference internal" href="#adoption-of-the-configuration-file">Adoption of the configuration file</a></li>
<li class="toctree-l3"><a class="reference internal" href="#configuration-file-and-database">Configuration file and database</a></li>
<li class="toctree-l3"><a class="reference internal" href="#the-build-process">The build process</a></li>
<li class="toctree-l3"><a class="reference internal" href="#dependencies">Dependencies</a></li>
<li class="toctree-l3"><a class="reference internal" href="#footnotes">Footnotes</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Development</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../install.html">Development installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../guides/index.html">Development guides</a></li>
<li class="toctree-l1"><a class="reference internal" href="../design.html">Designing Read the Docs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../docs.html">Building and contributing to documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../style-guide.html">Documentation style guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../front-end.html">Front-end development</a></li>
<li class="toctree-l1"><a class="reference internal" href="../i18n.html">Internationalization</a></li>
<li class="toctree-l1"><a class="reference internal" href="../migrations.html">Database migrations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../server-side-search.html">Server side search</a></li>
<li class="toctree-l1"><a class="reference internal" href="../search-integration.html">Server side search integration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../aws-temporary-credentials.html">AWS temporary credentials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../subscriptions.html">Subscriptions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../github-app.html">GitHub App</a></li>
<li class="toctree-l1"><a class="reference internal" href="../settings.html">Interesting settings</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tests.html">Testing</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="移动版导航菜单" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Read the Docs developer documentation</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="页面导航">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">Design documents</a></li>
      <li class="breadcrumb-item active">YAML configuration file</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/readthedocs/readthedocs.org/blob/main/docs/dev/design/yaml-file.rst" class="fa fa-github"> 在 GitHub 上编辑</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="yaml-configuration-file">
<h1>YAML configuration file<a class="headerlink" href="#yaml-configuration-file" title="Link to this heading"></a></h1>
<section id="background">
<h2>Background<a class="headerlink" href="#background" title="Link to this heading"></a></h2>
<p>The current YAML configuration file is in beta state.
There are many options and features that it doesn't support yet.
This document will serve as a design document for discuss how to implement the missing features.</p>
</section>
<section id="scope">
<h2>Scope<a class="headerlink" href="#scope" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p>Finish the spec to include all the missing options</p></li>
<li><p>Have consistency around the spec</p></li>
<li><p>Proper documentation for the end user</p></li>
<li><p>Allow to specify the spec's version used on the YAML file</p></li>
<li><p>Collect/show metadata about the YAML file and build configuration</p></li>
<li><p>Promote the adoption of the configuration file</p></li>
</ul>
</section>
<section id="rtd-settings">
<h2>RTD settings<a class="headerlink" href="#rtd-settings" title="Link to this heading"></a></h2>
<p>No all the RTD settings are applicable to the YAML file,
others are applicable for each build (or version),
and others for the global project.</p>
<section id="not-applicable-settings">
<h3>Not applicable settings<a class="headerlink" href="#not-applicable-settings" title="Link to this heading"></a></h3>
<p>Those settings can't be on the YAML file because:
may depend for the initial project setup,
are planned to be removed,
security and privacy reasons.</p>
<ul class="simple">
<li><p>Project Name</p></li>
<li><p>Repo URL</p></li>
<li><p>Repo type</p></li>
<li><p>Privacy level (this feature is planned to be removed <a class="footnote-reference brackets" href="#privacy-level" id="id1" role="doc-noteref"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></a>)</p></li>
<li><p>Project description (this feature is planned to be removed <a class="footnote-reference brackets" href="#project-description" id="id2" role="doc-noteref"><span class="fn-bracket">[</span>2<span class="fn-bracket">]</span></a>)</p></li>
<li><p>Single version</p></li>
<li><p>Default branch</p></li>
<li><p>Default version</p></li>
<li><p>Domains</p></li>
<li><p>Active versions</p></li>
<li><p>Translations</p></li>
<li><p>Subprojects</p></li>
<li><p>Integrations</p></li>
<li><p>Notifications</p></li>
<li><p>Language</p></li>
<li><p>Programming Language</p></li>
<li><p>Project homepage</p></li>
<li><p>Tags</p></li>
<li><p>Analytics code</p></li>
<li><p>Global redirects</p></li>
</ul>
</section>
<section id="global-settings">
<h3>Global settings<a class="headerlink" href="#global-settings" title="Link to this heading"></a></h3>
<p>To keep consistency with the per-version settings and avoid confusion,
this settings will not be stored in the YAML file and will be stored in the database only.</p>
</section>
<section id="local-settings">
<h3>Local settings<a class="headerlink" href="#local-settings" title="Link to this heading"></a></h3>
<p>Those configurations will be read from the YAML file in the current version that is being built.</p>
<p>Several settings are already implemented and documented on
<a class="reference external" href="https://docs.readthedocs.io/en/latest/yaml-config.html">https://docs.readthedocs.io/en/latest/yaml-config.html</a>.
So, they aren't covered with much detail here.</p>
<ul class="simple">
<li><p>Documentation type</p></li>
<li><p>Project installation (virtual env, requirements file, sphinx configuration file, etc)</p></li>
<li><p>Additional builds (pdf, epub)</p></li>
<li><p>Python interpreter</p></li>
<li><p>Per-version redirects</p></li>
</ul>
</section>
</section>
<section id="configuration-file">
<h2>Configuration file<a class="headerlink" href="#configuration-file" title="Link to this heading"></a></h2>
<section id="format">
<h3>Format<a class="headerlink" href="#format" title="Link to this heading"></a></h3>
<p>The file format is based on the YAML spec 1.2 <a class="footnote-reference brackets" href="#yaml-spec" id="id3" role="doc-noteref"><span class="fn-bracket">[</span>3<span class="fn-bracket">]</span></a>
(latest version on the time of this writing).</p>
<p>The file must be on the root directory of the repository, and must be named as:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">readthedocs.yml</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">readthedocs.yaml</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">.readthedocs.yml</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">.readthedocs.yaml</span></code></p></li>
</ul>
</section>
<section id="conventions">
<h3>Conventions<a class="headerlink" href="#conventions" title="Link to this heading"></a></h3>
<p>The spec of the configuration file must use this conventions.</p>
<ul class="simple">
<li><p>Use <code class="xref py py-obj docutils literal notranslate"><span class="pre">[]</span></code> to indicate an empty list</p></li>
<li><p>Use <code class="xref py py-obj docutils literal notranslate"><span class="pre">null</span></code> to indicate a null value</p></li>
<li><p>Use <code class="xref py py-obj docutils literal notranslate"><span class="pre">all</span></code> (internal string keyword) to indicate that all options are included on a list with predetermined choices.</p></li>
<li><p>Use <code class="xref py py-obj docutils literal notranslate"><span class="pre">true</span></code>  and <code class="xref py py-obj docutils literal notranslate"><span class="pre">false</span></code> as only options on boolean fields</p></li>
</ul>
</section>
<section id="spec">
<h3>Spec<a class="headerlink" href="#spec" title="Link to this heading"></a></h3>
<p>The current spec is documented on <a class="reference external" href="https://docs.readthedocs.io/en/latest/yaml-config.html">https://docs.readthedocs.io/en/latest/yaml-config.html</a>.
It will be used as base for the future spec.
The spec will be written using a validation schema such as <a class="reference external" href="https://json-schema-everywhere.github.io/yaml">https://json-schema-everywhere.github.io/yaml</a>.</p>
</section>
</section>
<section id="versioning-the-spec">
<h2>Versioning the spec<a class="headerlink" href="#versioning-the-spec" title="Link to this heading"></a></h2>
<p>The version of the spec that the user wants to use will be specified on the YAML file.
The spec only will have mayor versions (1.0, not 1.2) <a class="footnote-reference brackets" href="#specversioning" id="id4" role="doc-noteref"><span class="fn-bracket">[</span>4<span class="fn-bracket">]</span></a>.
For keeping compatibility with older projects using a configuration file without a version,
the latest compatible version will be used (1.0).</p>
</section>
<section id="adoption-of-the-configuration-file">
<h2>Adoption of the configuration file<a class="headerlink" href="#adoption-of-the-configuration-file" title="Link to this heading"></a></h2>
<p>When a user creates a new project or it's on the settings page,
we could suggest her/him an example of a functional configuration file with a minimal setup.
And making clear where to put global configurations.</p>
<p>For users that already have a project,
we can suggest him/her a configuration file on each build based on the current settings.</p>
</section>
<section id="configuration-file-and-database">
<h2>Configuration file and database<a class="headerlink" href="#configuration-file-and-database" title="Link to this heading"></a></h2>
<p>The settings used in the build from the configuration file
(and other metadata) needs to be stored in the database,
this is for later usage only, not to populate existing fields.</p>
</section>
<section id="the-build-process">
<h2>The build process<a class="headerlink" href="#the-build-process" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p>The repository is updated</p></li>
<li><p>Checkout to the current version</p></li>
<li><p>Retrieve the settings from the database</p></li>
<li><p>Try to parse the YAML file (the build fails if there is an error)</p></li>
<li><p>Merge the both settings (YAML file and database)</p></li>
<li><p>The version is built according to the settings</p></li>
<li><p>The settings used to build the documentation can be seen by the user</p></li>
</ul>
</section>
<section id="dependencies">
<h2>Dependencies<a class="headerlink" href="#dependencies" title="Link to this heading"></a></h2>
<p>Current repository which contains the code related to the configuration file:
<a class="reference external" href="https://github.com/readthedocs/readthedocs-build">https://github.com/readthedocs/readthedocs-build</a></p>
</section>
<section id="footnotes">
<h2>Footnotes<a class="headerlink" href="#footnotes" title="Link to this heading"></a></h2>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="privacy-level" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id1">1</a><span class="fn-bracket">]</span></span>
<p><a class="reference external" href="https://github.com/readthedocs/readthedocs.org/issues/2663">https://github.com/readthedocs/readthedocs.org/issues/2663</a></p>
</aside>
<aside class="footnote brackets" id="project-description" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id2">2</a><span class="fn-bracket">]</span></span>
<p><a class="reference external" href="https://github.com/readthedocs/readthedocs.org/issues/3689">https://github.com/readthedocs/readthedocs.org/issues/3689</a></p>
</aside>
<aside class="footnote brackets" id="yaml-spec" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id3">3</a><span class="fn-bracket">]</span></span>
<p><a class="reference external" href="https://yaml.org/spec/1.2/spec.html">https://yaml.org/spec/1.2/spec.html</a></p>
</aside>
<aside class="footnote brackets" id="specversioning" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id4">4</a><span class="fn-bracket">]</span></span>
<p><a class="reference external" href="https://github.com/readthedocs/readthedocs.org/issues/3806">https://github.com/readthedocs/readthedocs.org/issues/3806</a></p>
</aside>
</aside>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="页脚">
        <a href="theme-context.html" class="btn btn-neutral float-left" title="Read the Docs data passed to Sphinx build context" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> 上一页</a>
        <a href="../install.html" class="btn btn-neutral float-right" title="Development installation" accesskey="n" rel="next">下一页 <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; 版权所有 Read the Docs, Inc &amp; contributors。</p>
  </div>

  利用 <a href="https://www.sphinx-doc.org/">Sphinx</a> 构建，使用的 
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">主题</a>
    由 <a href="https://readthedocs.org">Read the Docs</a> 开发.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>