# SOME DESCRIPTIVE TITLE.
# Copyright (C) Read the Docs, Inc & contributors
# This file is distributed under the same license as the Read the Docs developer documentation package.
# FIRST AUTHOR <EMAIL@ADDRESS>, YEAR.
#
#, fuzzy
msgid ""
msgstr ""
"Project-Id-Version: Read the Docs developer documentation latest\n"
"Report-Msgid-Bugs-To: \n"
"POT-Creation-Date: 2025-11-24 08:20+0000\n"
"PO-Revision-Date: YEAR-MO-DA HO:MI+ZONE\n"
"Last-Translator: FULL NAME <EMAIL@ADDRESS>\n"
"Language-Team: LANGUAGE <LL@li.org>\n"
"Language: zh_CN\n"
"MIME-Version: 1.0\n"
"Content-Type: text/plain; charset=UTF-8\n"
"Content-Transfer-Encoding: 8bit\n"

#: ../../../design/build-images.rst:2
msgid "Build images"
msgstr ""

#: ../../../design/build-images.rst:4
msgid ""
"This document describes how Read the Docs uses the `Docker Images`_ and how "
"they are named. Besides, it proposes a path forward about a new way to "
"create, name and use our Docker build images to reduce its complexity and "
"support installation of other languages (e.g. nodejs, rust, go) as extra "
"requirements."
msgstr ""

#: ../../../design/build-images.rst:12
msgid "Introduction"
msgstr ""

#: ../../../design/build-images.rst:14
msgid ""
"We use Docker images to build user's documentation. Each time a build is "
"triggered, one of our VMs picks the task and go through different steps:"
msgstr ""

#: ../../../design/build-images.rst:18
msgid "run some application code to spin up a Docker image into a container"
msgstr ""

#: ../../../design/build-images.rst:19 ../../../design/build-images.rst:113
msgid "execute ``git`` inside the container to clone the repository"
msgstr ""

#: ../../../design/build-images.rst:20 ../../../design/build-images.rst:114
msgid ""
"analyze and parse files (``.readthedocs.yaml``) from the repository "
"*outside* the container"
msgstr ""

#: ../../../design/build-images.rst:21
msgid "spin up a new Docker container based on the config file"
msgstr ""

#: ../../../design/build-images.rst:22 ../../../design/build-images.rst:117
msgid ""
"create the environment and install docs' dependencies inside the container"
msgstr ""

#: ../../../design/build-images.rst:23 ../../../design/build-images.rst:118
msgid "execute build commands inside the container"
msgstr ""

#: ../../../design/build-images.rst:24 ../../../design/build-images.rst:119
msgid "push the output generated by build commands to the storage"
msgstr ""

#: ../../../design/build-images.rst:26
msgid ""
"*All* those steps depends on specific commands versions: ``git``, "
"``python``, ``virtualenv``, ``conda``, etc. Currently, we are pinning only a "
"few of them in our Docker images and that have caused issues when re-"
"deploying these images with bugfixes: **the images are not reproducible over "
"time**."
msgstr ""

#: ../../../design/build-images.rst:32
msgid ""
"We have been improving the reproducibility of our images by adding some "
"tests cases. These are run inside the Docker image after it's built and "
"check that it contains the versions we expect."
msgstr ""

#: ../../../design/build-images.rst:35
msgid ""
"To allow users to pin the image we ended up exposing three images: "
"``stable``, ``latest`` and ``testing``. With that naming, we were able to "
"bugfix issues and add more features on each image without asking the users "
"to change the image selected in their config file."
msgstr ""

#: ../../../design/build-images.rst:39
msgid ""
"Then, when a completely different image appeared and after testing "
"``testing`` image enough, we discarded ``stable``, old ``latest`` became the "
"new ``stable`` and old ``testing`` became the new ``latest``. This produced "
"issues to people pinning their images to any of these names because after "
"this change, *we changed all the images for all the users* and many build "
"issues arose!"
msgstr ""

#: ../../../design/build-images.rst:46
msgid "Goals"
msgstr ""

#: ../../../design/build-images.rst:48
msgid ""
"release completely new Docker images without forcing users to change their "
"pinned image (``stable``, ``latest``, ``testing``)"
msgstr ""

#: ../../../design/build-images.rst:49
msgid "allow users to select language requirements instead of an image name"
msgstr ""

#: ../../../design/build-images.rst:50
msgid ""
"use a ``base`` image with the dependencies that don't change frequently (OS "
"and base requirements)"
msgstr ""

#: ../../../design/build-images.rst:51
msgid "``base`` image naming is tied to the OS version (e.g. Ubuntu LTS)"
msgstr ""

#: ../../../design/build-images.rst:52
msgid ""
"allow us to add/update a Python version without affecting the ``base`` image"
msgstr ""

#: ../../../design/build-images.rst:53
msgid "reduce size on builder VM disks by sharing Docker image layers"
msgstr ""

#: ../../../design/build-images.rst:54
msgid "allow users to specify extra languages (e.g. nodejs, rust, go)"
msgstr ""

#: ../../../design/build-images.rst:55
msgid ""
"de-motivate the usage of ``stable``, ``latest`` and ``testing``; and promote "
"declaring language requirements instead"
msgstr ""

#: ../../../design/build-images.rst:56
msgid ""
"new images won't contain old/deprecated OS (eg. Ubuntu 18) and Python "
"versions (eg. 3.5, miniconda2)"
msgstr ""

#: ../../../design/build-images.rst:57
msgid ""
"install language requirements *at built time* using ``asdf`` and its plugins"
msgstr ""

#: ../../../design/build-images.rst:58
msgid "create local mirrors for all languages supported"
msgstr ""

#: ../../../design/build-images.rst:59
msgid ""
"deleting a pre-built image won't make builds to fail; only make them slower"
msgstr ""

#: ../../../design/build-images.rst:60
msgid ""
"support only the latest Ubuntu LTS version and keep the previous one as long "
"as it's officially supported"
msgstr ""

#: ../../../design/build-images.rst:64
msgid "Non goals"
msgstr ""

#: ../../../design/build-images.rst:66
msgid "allow creation/usage of custom Docker images"
msgstr ""

#: ../../../design/build-images.rst:67
msgid "allow to execute arbitrary commands via hooks (eg. ``pre_build``)"
msgstr ""

#: ../../../design/build-images.rst:68
msgid "automatically build & push *all* images on commit"
msgstr ""

#: ../../../design/build-images.rst:69
msgid "pre-built multiple images for all the languages combinations"
msgstr ""

#: ../../../design/build-images.rst:73
msgid "Pre-built build image structure"
msgstr ""

#: ../../../design/build-images.rst:77
msgid ""
"The new pre-built images will depend only on the Ubuntu OS. They will "
"contain all the requirements to add extra languages support at built time "
"via ``asdf`` command."
msgstr ""

#: ../../../design/build-images.rst:80
msgid "``ubuntu20-base``"
msgstr ""

#: ../../../design/build-images.rst:82
msgid "labels"
msgstr ""

#: ../../../design/build-images.rst:83
msgid "environment variables"
msgstr ""

#: ../../../design/build-images.rst:84
msgid "system dependencies"
msgstr ""

#: ../../../design/build-images.rst:85
msgid "install requirements"
msgstr ""

#: ../../../design/build-images.rst:86
msgid "LaTeX dependencies (for PDF generation)"
msgstr ""

#: ../../../design/build-images.rst:87
msgid "languages version manager (``asdf``) and its plugins for each language"
msgstr ""

#: ../../../design/build-images.rst:88
msgid "UID and GID"
msgstr ""

#: ../../../design/build-images.rst:90
msgid ""
"Instead of building all the Docker image per language versions combination, "
"it will be easier to install all of them at build time using the same steps. "
"Installing a language only adds a few seconds when binaries are provided. "
"However, to reduce the time to install these languages as much as possible, "
"a local mirror hosted on S3 for each language will be created."
msgstr ""

#: ../../../design/build-images.rst:96
msgid ""
"It's important to note that Python does not provide binaries and compiling a "
"version takes around ~2 minutes. However, the Python versions could be pre-"
"compiled and expose their binaries via S3 to builders. Then, at build time, "
"the builder will only download the binary and copy it in the correct path."
msgstr ""

#: ../../../design/build-images.rst:102
msgid ""
"Depending on the demand, Read the Docs may pre-build the most common "
"combinations of languages used by users. For example, "
"``ubuntu20+python39+node14`` or ``ubuntu20+python39+node14+rust1``. However, "
"this is seen as an optimization for the future and it's not required for "
"this document."
msgstr ""

#: ../../../design/build-images.rst:108
msgid "Build steps"
msgstr ""

#: ../../../design/build-images.rst:110
msgid "With this new approach, the steps followed by a builder will be:"
msgstr ""

#: ../../../design/build-images.rst:112
msgid ""
"run some application code to spin up the ``-base`` Docker image into a "
"container"
msgstr ""

#: ../../../design/build-images.rst:115
msgid ""
"spin up a new Docker container **based on the Ubuntu OS specified** in the "
"config file"
msgstr ""

#: ../../../design/build-images.rst:116
msgid "**install all language dependencies from the cache**"
msgstr ""

#: ../../../design/build-images.rst:121
msgid "The main difference with the current approach are:"
msgstr ""

#: ../../../design/build-images.rst:123
msgid "the image to spin up is selected depending on the OS version"
msgstr ""

#: ../../../design/build-images.rst:124
msgid "all language dependencies are installed at build time"
msgstr ""

#: ../../../design/build-images.rst:125
msgid ""
"languages not offering binaries are pre-compiled by Read the Docs and stored "
"in the cache"
msgstr ""

#: ../../../design/build-images.rst:126
msgid ""
"miniconda/mambaforge are now managed with the same management tool (e.g. "
"``asdf install python miniconda3-4.7.12``)"
msgstr ""

#: ../../../design/build-images.rst:130
msgid "Specifying extra languages requirements"
msgstr ""

#: ../../../design/build-images.rst:132
msgid ""
"Different users may have different requirements. People with specific "
"language dependencies will be able to install them by using ``.readthedocs."
"yaml`` config file. Example:"
msgstr ""

#: ../../../design/build-images.rst:136
msgid ""
"build:\n"
"  os: ubuntu20\n"
"  languages:\n"
"    python: \"3.9\"  # supports \"pypy3\", \"miniconda3\" and "
"\"mambaforge\"\n"
"    nodejs: \"14\"\n"
"    rust: \"1.54\"\n"
"    golang: \"1.17\""
msgstr ""

#: ../../../design/build-images.rst:146
msgid "Important highlights:"
msgstr ""

#: ../../../design/build-images.rst:148
msgid ""
"do not treat Python language different from the others (will help us to "
"support other non-Python doctools in the future)"
msgstr ""

#: ../../../design/build-images.rst:149
msgid ""
"specifying ``build.languages.python: \"3\"`` will use Python version ``3.x."
"y``, and may differ between builds"
msgstr ""

#: ../../../design/build-images.rst:150
msgid ""
"specifying ``build.languages.python: \"3.9\"`` will use Python version ``3.9."
"y``, and may differ between builds"
msgstr ""

#: ../../../design/build-images.rst:151
msgid ""
"specifying ``build.languages.nodejs: \"14\"`` will use nodejs version ``14.x."
"y``, and may differ between builds"
msgstr ""

#: ../../../design/build-images.rst:152
msgid ""
"if no full version is declared, it will try first latest available on our "
"cache, and then the latest on ``asdf`` (it has to match the first part of "
"the version declared)"
msgstr ""

#: ../../../design/build-images.rst:154
msgid "specifying minor language versions is not allowed (e.g. ``3.7.11``)"
msgstr ""

#: ../../../design/build-images.rst:155
msgid "not specifying ``build.os`` will make the config file parser to fail"
msgstr ""

#: ../../../design/build-images.rst:156
msgid ""
"not specifying ``build.languages`` will make the config file parsing to fail "
"(at least one is required)"
msgstr ""

#: ../../../design/build-images.rst:157
msgid ""
"specifying only ``build.languages.nodejs`` and using Sphinx to build the "
"docs, will make the build to fail (e.g. \"Command not found\")"
msgstr ""

#: ../../../design/build-images.rst:158
msgid ""
"``build.image`` is incompatible with ``build.os`` or ``build.languages`` and "
"will produce an error"
msgstr ""

#: ../../../design/build-images.rst:159
msgid ""
"``python.version`` is incompatible with ``build.os`` or ``build.languages`` "
"and will produce an error"
msgstr ""

#: ../../../design/build-images.rst:160
msgid ""
"Ubuntu 18 will still be available via ``stable`` and ``latest`` images, but "
"not in new ones"
msgstr ""

#: ../../../design/build-images.rst:161
msgid ""
"only a subset (not defined yet) of ``python``, ``nodejs``, ``rust`` and "
"``go`` versions on ``asdf`` are available to select"
msgstr ""

#: ../../../design/build-images.rst:165
msgid ""
"We are moving away from users specifying a particular Docker image. With the "
"new approach, users will specify the languages requirements they need, and "
"Read the Docs will decide if it will use a pre-built image or will spin up "
"the base one and install these languages on the fly."
msgstr ""

#: ../../../design/build-images.rst:169
msgid ""
"However, ``build.image`` will be still available for backward compatibility "
"with ``stable``, ``latest`` and ``testing`` but won't support the new "
"``build.languages`` config."
msgstr ""

#: ../../../design/build-images.rst:171
msgid ""
"Note that knowing exactly what packages users are installing, could allow us "
"to pre-build the most common combinations used images: "
"``ubuntu20+py39+node14``."
msgstr ""

#: ../../../design/build-images.rst:176
msgid "Time required to install languages at build time"
msgstr ""

#: ../../../design/build-images.rst:178
msgid ""
"Testings using ``time`` command in ASG instances to install extra languages "
"took these \"real\" times:"
msgstr ""

#: ../../../design/build-images.rst:180
msgid "``build-default``"
msgstr ""

#: ../../../design/build-images.rst:182
msgid "python 3.9.6: 2m21.331s"
msgstr ""

#: ../../../design/build-images.rst:183
msgid "mambaforge 4.10.1: 0m26.291s"
msgstr ""

#: ../../../design/build-images.rst:184
msgid "miniconda3 4.7.12: 0m9.955s"
msgstr ""

#: ../../../design/build-images.rst:185
msgid "nodejs 14.17.5: 0m5.603s"
msgstr ""

#: ../../../design/build-images.rst:186
msgid "rust 1.54.0: 0m13.587s"
msgstr ""

#: ../../../design/build-images.rst:187
msgid "golang 1.17: 1m30.428s"
msgstr ""

#: ../../../design/build-images.rst:189
msgid "``build-large``"
msgstr ""

#: ../../../design/build-images.rst:191
msgid "python 3.9.6: 2m33.688s"
msgstr ""

#: ../../../design/build-images.rst:192
msgid "mambaforge 4.10.1: 0m28.781s"
msgstr ""

#: ../../../design/build-images.rst:193
msgid "miniconda3 4.7.12: 0m10.551s"
msgstr ""

#: ../../../design/build-images.rst:194
msgid "nodejs 14.17.5: 0m6.136s"
msgstr ""

#: ../../../design/build-images.rst:195
msgid "rust 1.54.0: 0m14.716s"
msgstr ""

#: ../../../design/build-images.rst:196
msgid "golang 1.17: 1m36.470s"
msgstr ""

#: ../../../design/build-images.rst:198
msgid ""
"Note that the only one that required compilation was Python. All the others, "
"spent 100% of its time downloading the binary. These download times are *way "
"better from EU* with a home internet connection."
msgstr ""

#: ../../../design/build-images.rst:202
msgid ""
"In the worst scenario: \"none of the specified language version has a pre-"
"built image\", the build will require ~5 minutes to install all the language "
"requirements. By providing *only* pre-built images with the Python version "
"(that's the most time consuming), build times will only require ~2 minutes "
"to install the others. However, requiring one version of each language is "
"not a common case."
msgstr ""

#: ../../../design/build-images.rst:209
msgid "Cache language binaries on S3"
msgstr ""

#: ../../../design/build-images.rst:211
msgid ""
"``asdf`` scripts can be altered to download the ``.tar.gz`` dist files from "
"a different mirror than the official one. Read the Docs can make usage of "
"this to create a mirror hosted locally on S3 to get faster download speeds. "
"This will make a good improvement for languages that offer binaries: "
"``nodejs``, ``rust`` and ``go``:"
msgstr ""

#: ../../../design/build-images.rst:215
msgid ""
"``nodejs`` uses ``NODEJS_ORG_MIRROR``: https://github.com/asdf-vm/asdf-"
"nodejs/blob/f9957f3f256ebbb3fdeebcaed5082ad305222be6/lib/utils.sh#L5"
msgstr ""

#: ../../../design/build-images.rst:216
msgid ""
"``rust`` uses ``RUSTUP_UPDATE_ROOT``: https://github.com/rust-lang/rustup/"
"blob/499e582bc8ba34fa7e84d5120001aae31151d3c8/rustup-init.sh#L23"
msgstr ""

#: ../../../design/build-images.rst:217
msgid ""
"``go`` has the URL hardcoded: https://github.com/kennyp/asdf-golang/blob/"
"cc8bc47d4877beed61e10815d46669e1eaaa0bbe/bin/download#L54"
msgstr ""

#: ../../../design/build-images.rst:219
msgid ""
"However, currently Python does not offer binaries and a different solution "
"is needed. Python versions can be pre-compiled once and expose the output on "
"the S3 for the builders to download and extract in the correct PATH."
msgstr ""

#: ../../../design/build-images.rst:224
msgid ""
"Since we are building a special cache for pre-compiled Python versions, we "
"could use the same method for all the other languages instead of creating a "
"full mirror (many Gigabytes) This simple `bash script`_ download the "
"language sources, compiles it and upload it to S3 without requiring a "
"mirror. Note that it works in the same way for all the languages, not just "
"for Python."
msgstr ""

#: ../../../design/build-images.rst:232
msgid "Questions"
msgstr ""

#: ../../../design/build-images.rst:235
msgid "What Python versions will be pre-compiled and cached?"
msgstr ""

#: ../../../design/build-images.rst:237
msgid "At start only a small subset of Python version will be pre-compiled:"
msgstr ""

#: ../../../design/build-images.rst:239
msgid "2.7.x"
msgstr ""

#: ../../../design/build-images.rst:240
msgid "3.7.x"
msgstr ""

#: ../../../design/build-images.rst:241
msgid "3.8.x"
msgstr ""

#: ../../../design/build-images.rst:242
msgid "3.9.x"
msgstr ""

#: ../../../design/build-images.rst:243
msgid "3.10.x"
msgstr ""

#: ../../../design/build-images.rst:244
msgid "pypy3.x"
msgstr ""

#: ../../../design/build-images.rst:247
msgid "How do we upgrade a Python version?"
msgstr ""

#: ../../../design/build-images.rst:249
msgid ""
"Python patch versions can be upgraded by re-compiling the new patch version "
"and making it available in our cache. For example, if version 3.9.6 is the "
"one available and 3.9.7 is released, *after updating our cache*:"
msgstr ""

#: ../../../design/build-images.rst:253
msgid ""
"users specifying ``build.languages.python: \"3.9\"`` will get the 3.9.7 "
"version"
msgstr ""

#: ../../../design/build-images.rst:254
msgid ""
"users specifying ``build.languages.python: \"3\"`` will get the 3.9.7 version"
msgstr ""

#: ../../../design/build-images.rst:256
msgid ""
"As we will have control over these version, we can decide *when* to upgrade "
"(if ever required) and we can roll back if the new pre-compiled version was "
"built with a problem."
msgstr ""

#: ../../../design/build-images.rst:261
msgid ""
"Python versions may need to be re-compiled each time that the ``-base`` "
"image is re-built. This is due that some underlying libraries that Python "
"depend on may have changed."
msgstr ""

#: ../../../design/build-images.rst:266
msgid ""
"Installing always the latest version is harder to maintain. It will require "
"building the newest version each time a new patch version is released. "
"Because of that, Read the Docs will always be behind official releases. "
"Besides, it will give projects different versions more often."
msgstr ""

#: ../../../design/build-images.rst:271
msgid ""
"Exposing to the user the patch version would require to cache many different "
"versions ourselves, and if the user selects one patched version that we "
"don't have cached by mistake, those builds will add extra build time."
msgstr ""

#: ../../../design/build-images.rst:276
msgid "How do we add a Python version?"
msgstr ""

#: ../../../design/build-images.rst:278
msgid "Adding a new Python version requires:"
msgstr ""

#: ../../../design/build-images.rst:280
msgid "pre-compile the desired version for each Ubuntu OS version supported"
msgstr ""

#: ../../../design/build-images.rst:281
msgid "upload the compressed output to S3"
msgstr ""

#: ../../../design/build-images.rst:282
msgid "add the supported version to the config file validator"
msgstr ""

#: ../../../design/build-images.rst:285
msgid "How do we remove an old Python version?"
msgstr ""

#: ../../../design/build-images.rst:287
msgid ""
"At some point, an old version of Python will be deprecated (eg. 3.4) and "
"will be removed. To achieve this, we can just remove the pre-compiled Python "
"version from the cache."
msgstr ""

#: ../../../design/build-images.rst:290
msgid ""
"However, unless it's strictly needed for some specific reason, we shouldn't "
"require to remove support for a Python version as long as we support the "
"Ubuntu OS version where this version was compiled for."
msgstr ""

#: ../../../design/build-images.rst:293
msgid ""
"In any case, we will know which projects are using these versions because "
"they are pinning these specific versions in the config file. We could show a "
"message in the build output page and also send them an email with the EOL "
"date for this image."
msgstr ""

#: ../../../design/build-images.rst:296
msgid ""
"However, removing pre-compiled Python version that it's being currently used "
"by some users won't make their builds to fail. Instead, that Python version "
"will be compiled and installed at build time; adding a \"penalization\" time "
"to those projects and motivating them to move forward to a newer version."
msgstr ""

#: ../../../design/build-images.rst:301
msgid "How do we upgrade system versions?"
msgstr ""

#: ../../../design/build-images.rst:303
msgid ""
"We usually don't upgrade these dependencies unless we upgrade the Ubuntu "
"version. So, they will be only upgraded when we go from Ubuntu 18.04 LTS to "
"Ubuntu 20.04 LTS for example."
msgstr ""

#: ../../../design/build-images.rst:306
msgid "Examples of these versions are:"
msgstr ""

#: ../../../design/build-images.rst:308
msgid "doxygen"
msgstr ""

#: ../../../design/build-images.rst:309
msgid "git"
msgstr ""

#: ../../../design/build-images.rst:310
msgid "subversion"
msgstr ""

#: ../../../design/build-images.rst:311
msgid "pandoc"
msgstr ""

#: ../../../design/build-images.rst:312
msgid "swig"
msgstr ""

#: ../../../design/build-images.rst:313
msgid "latex"
msgstr ""

#: ../../../design/build-images.rst:315
msgid ""
"This case will introduce a new ``base`` image. Example, ``ubuntu22-base`` in "
"2022. Note that these images will be completely isolated from the rest and "
"don't require them to rebuild. This also allow us to start testing a newer "
"Ubuntu version (e.g. 22.04 LTS) without breaking people's builds, even "
"before it's officially released."
msgstr ""

#: ../../../design/build-images.rst:321
msgid "How do we add an extra requirement?"
msgstr ""

#: ../../../design/build-images.rst:323
msgid ""
"In case we need to add an extra requirement to the ``base`` image, we will "
"need to rebuild all of them. The new image *may have different package "
"versions* since there may be updates on the Ubuntu repositories. This "
"conveys some risk here, but in general we shouldn't require to add packages "
"to the base images."
msgstr ""

#: ../../../design/build-images.rst:328
msgid ""
"In case we need an extra requirement for *all our images*, I'd recommend to "
"add it when creating a new base image."
msgstr ""

#: ../../../design/build-images.rst:331
msgid ""
"If it's strongly needed and we can't wait for a new base image, we could "
"install it at build time in a similar way as we do with ``build."
"apt_packages`` as a temporal workaround."
msgstr ""

#: ../../../design/build-images.rst:335
msgid "How do we create a mirror for each language?"
msgstr ""

#: ../../../design/build-images.rst:337
msgid "A mirror can be created with ``wget`` together with ``rclone``:"
msgstr ""

#: ../../../design/build-images.rst:339
msgid "Download all the files from the official mirror:"
msgstr ""

#: ../../../design/build-images.rst:341
msgid ""
"# https://stackoverflow.com/questions/29802579/create-private-mirror-of-http-"
"nodejs-org-dist\n"
"wget --mirror --convert-links --adjust-extension --page-requisites --no-"
"parent -e robots=off http://nodejs.org/dist"
msgstr ""

#: ../../../design/build-images.rst:346
msgid "Upload all the files to S3:"
msgstr ""

#: ../../../design/build-images.rst:348
msgid ""
"# https://rclone.org/s3/\n"
"rclone sync -i nodejs.org s3:languages"
msgstr ""

#: ../../../design/build-images.rst:356
msgid "Downloading a copy of the official mirror took 15m and 52Gb."
msgstr ""

#: ../../../design/build-images.rst:359
msgid "How local development will work with the new approach?"
msgstr ""

#: ../../../design/build-images.rst:361
msgid ""
"Local development will require scripts to clone the official mirrors for "
"each language and upload them to MinIO (S3). Besides, a script to define a "
"set of Python version, pre-compile them and also upload them to S3."
msgstr ""

#: ../../../design/build-images.rst:364
msgid ""
"This is already covered by this simple `bash script`_ and tested in this PR "
"with a POC: https://github.com/readthedocs/readthedocs.org/pull/8453"
msgstr ""

#: ../../../design/build-images.rst:369
msgid "Deprecation plan"
msgstr ""

#: ../../../design/build-images.rst:371
msgid ""
"After this design document gets implemented and tested, all our current "
"images (``stable``, ``latest``, ``testing``) will be deprecated and their "
"usage will be de-motivated. However, we could keep them on our builders to "
"give users a good time to migrate their projects to the new ones."
msgstr ""

#: ../../../design/build-images.rst:375
msgid ""
"We may want to keep only the latest Ubuntu LTS release available in "
"production, with a special consideration for our current Ubuntu 18.04 LTS on "
"``stable``, ``latest`` and ``testing`` because 100% of the projects depend "
"on them currently. Once Ubuntu 22.04 LTS is released, we should communicate "
"that Ubuntu 20.04 LTS is deprecated, and keep it available in our servers "
"during the time that's officially supported by Ubuntu during the "
"\"Maintenance updates\" (see \"Login term support and interim releases\" in "
"https://ubuntu.com/about/release-cycle). As an example, Ubuntu 22.04 LTS "
"will be officially released on April 2022 and we will offer support for it "
"until 2027."
msgstr ""

#: ../../../design/build-images.rst:384
msgid ""
"Deleting ``-base`` images from the build servers **will make project's "
"builds to fail**. We want to keep supporting them as much as we can, but "
"having a well-defined deprecation policy is a win."
msgstr ""

#: ../../../design/build-images.rst:389
msgid "Work required and rollout plan"
msgstr ""

#: ../../../design/build-images.rst:391
msgid ""
"The following steps are required to support the full proposal of this "
"document."
msgstr ""

#: ../../../design/build-images.rst:393
msgid "allow users to install extras languages requirements via config file"
msgstr ""

#: ../../../design/build-images.rst:395
msgid ""
"update config file to support ``build.os`` and ``build.languages`` config"
msgstr ""

#: ../../../design/build-images.rst:396
msgid "modify builder code to run ``asdf install`` for all supported languages"
msgstr ""

#: ../../../design/build-images.rst:398
msgid "build a new base Docker image with new structure (``ubuntu20-base``)"
msgstr ""

#: ../../../design/build-images.rst:400
msgid ""
"build new image with Ubuntu 20.04 LTS and pre-installed ``asdf`` with all "
"its plugins"
msgstr ""

#: ../../../design/build-images.rst:401
msgid "do not install any language version on base image"
msgstr ""

#: ../../../design/build-images.rst:402
msgid "deploy builders with new base image"
msgstr ""

#: ../../../design/build-images.rst:404
msgid ""
"At this point, we will have a full working setup. It will be opt-in by using "
"the new configs ``build.os`` and ``build.languages``. However, *all "
"languages* will be installed at build time; which will \"penalize\" all "
"projects because all of them will have to install Python."
msgstr ""

#: ../../../design/build-images.rst:409
msgid ""
"After testing this for some time, we can continue with the following steps "
"that provides a cache to optimize installation times:"
msgstr ""

#: ../../../design/build-images.rst:411
msgid "create mirrors on S3 for all supported languages"
msgstr ""

#: ../../../design/build-images.rst:412
msgid ""
"create mirror for pre-compiled latest 3 Python versions, Python 2.7 and PyPy3"
msgstr ""

#: ../../../design/build-images.rst:416
msgid "Conclusion"
msgstr ""

#: ../../../design/build-images.rst:418
msgid ""
"There is no need to differentiate the images by its state (stable, latest, "
"testing) but by its main base differences: OS. The version of the OS will "
"change many library versions, LaTeX dependencies, basic required commands "
"like git and more, that doesn't seem to be useful to have the same OS "
"version with different states."
msgstr ""

#: ../../../design/build-images.rst:424
msgid ""
"Allowing users to install extra languages by using the Config File will "
"cover most of the support requests we have had in the past. It also will "
"allow us to know more about how our users are using the platform to make "
"future decisions based on this data. Exposing users how we want them to use "
"our platform will allow us to be able to maintain it longer, than giving the "
"option to select a specific Docker image by name that we can't guarantee it "
"will be frozen."
msgstr ""

#: ../../../design/build-images.rst:429
msgid ""
"Finally, having the ability to deprecate and *remove* pre-built images from "
"our builders over time, will reduce the maintenance work required from the "
"core team. We can always support all the languages versions by installing "
"them at build time. The only required pre-built image for this are the OS ``-"
"base`` images. In fact, even after decided to deprecate and removed a pre-"
"built image from the builders, we can re-build it if we find that it's "
"affecting many projects and slowing down their builds too much, causing us "
"problems."
msgstr ""
